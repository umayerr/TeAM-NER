(function(){"use strict";var e={4631:function(e,t,n){var o=n(9798),s=n(4220),a=n(7700);function l(e,t,n,l,r,i){const c=(0,s.g2)("menu-bar"),d=(0,s.g2)("annotation-sidebar"),u=(0,s.g2)("q-drawer"),p=(0,s.g2)("start-page"),h=(0,s.g2)("annotation-page"),g=(0,s.g2)("review-page"),m=(0,s.g2)("q-page-container"),k=(0,s.g2)("q-layout"),b=(0,s.g2)("drag-n-drop-overlay"),y=(0,s.g2)("exit-dialog");return(0,s.uX)(),(0,s.CE)("div",{class:"fullscreen",onDragover:t[4]||(t[4]=(0,o.D$)(((...e)=>i.onDragEnter&&i.onDragEnter(...e)),["prevent"])),onDragenter:t[5]||(t[5]=(...e)=>i.onDragEnter&&i.onDragEnter(...e)),onDragleave:t[6]||(t[6]=(0,o.D$)(((...e)=>i.onDragLeave&&i.onDragLeave(...e)),["self"])),onDrop:t[7]||(t[7]=(0,o.D$)(((...e)=>i.onDrop&&i.onDrop(...e)),["stop","prevent"])),style:{"overflow-y":"scroll"}},[(0,s.Lk)("div",{style:(0,a.Tr)({"pointer-events":r.overlayActive?"none":"auto"})},[(0,s.bF)(k,{view:"hHh lpR fFf"},{default:(0,s.k6)((()=>["start"!==e.currentPage?((0,s.uX)(),(0,s.Wv)(c,{key:0})):(0,s.Q3)("",!0),(0,s.bF)(u,{"model-value":"start"!==e.currentPage,bordered:"",class:(0,a.C4)(e.$q.dark.isActive?"bg-dark":"bg-grey-2")},{default:(0,s.k6)((()=>[(0,s.bF)(d)])),_:1},8,["model-value","class"]),(0,s.bF)(m,null,{default:(0,s.k6)((()=>["start"===e.currentPage?((0,s.uX)(),(0,s.Wv)(p,{key:0,onTextFileLoaded:t[0]||(t[0]=e=>i.switchToPage("annotate")),onJsonFileLoaded:t[1]||(t[1]=e=>i.switchToPage("review"))})):(0,s.Q3)("",!0),"annotate"===e.currentPage?((0,s.uX)(),(0,s.Wv)(h,{key:1})):(0,s.Q3)("",!0),"review"===e.currentPage?((0,s.uX)(),(0,s.Wv)(g,{key:2})):(0,s.Q3)("",!0)])),_:1})])),_:1}),(0,s.bF)(b,{style:(0,a.Tr)({visibility:r.overlayActive&&null==r.pendingFileDrop?"visible":"hidden"})},null,8,["style"]),(0,s.bF)(y,{show:null!=r.pendingFileDrop&&"start"!=e.currentPage,onHide:t[2]||(t[2]=e=>r.pendingFileDrop=null),onConfirm:t[3]||(t[3]=e=>i.processFileDrop())},null,8,["show"])],4)],32)}var r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAIqUlEQVQYGZ3BCYydZaHG8f/zvt85c2Y6nZZu2sVSCoSpO0K5ceEmlmhUSmJQAcXdWBdwiVEJXMm9F7EqQUEToqkShWjiCmrRumtU0mCLRQE7BVu6zHS6zXbazpw553vf535jR1ONQnJ/PzGr/45tAgz0gR4Q9IOHbYYl/aWT/PDKvmL7L65e/kCeSmNTpUm2hGScqUiib8EyTuf/3gAyf2VA/J3+50sUzBJ/12N7lZmhpRJLA7ygnX3Fa86dg1vpyEQ7/zSKuxA/xxgUJScwW4eG2LAPJIHNS8oW91+8mnLjexXHp+SHj1o//qPZ8J94/XoCf2MZC6wjgl1ICCdBnk4uz55X67z23B5PlV4SxRsl/Uzol8ALhFO2wtwILxwAiWA7Zkn3n7Oad225P8ZvfsF0OedatHwAbl7HjMAsy1QCkC22i4rkIDRZunjJ8q5icXeknZyB0na2/VLEdqN3JMhfG1FcO0eyyUASmGmwlBhlDrF2t5b2vrW86d1403ZRCcyShbGMqfzKmIpsqAW8ZkFdAgyqFDqlg5HkLwe4anHhtG0EAy8U+qTwPc8/OPTjny3s33TL7d/b0jo8/aYwNLEubt2DHj4iKgWnEWRmmJ8ARxGLM+SuKC3qDpRGErgiCUMNKDFFTXxmV0s7+s/w9RJvoWJDluhzmy8VzyE19v32+h9+4D1U0ivXO0YomGUZkGVH4JilbwquBRKiJmFAnCLAAhsKg+viaU+0eaCTmdeIItkdQMSgcnCiUxucaNyx5pKBx2/8xskgxzv/96rkyy4jMGvgmrVgsGRLCG4HJgW1dnIencqKwhgkURGn2Igoh/nR8xJKwgYKxRDT4ERIQ80aRWR+Z3LlVy66gjtfdFW66HO/Y0bgHxhwxo62d2M+HgTtRNo11jEgwLOoSKJiUbmwR7kmBwOKQWlogjTURDGYSkaT/fv/wHm7H9TxooHuu4/AaSQBApEgUPmUzT3dhWr3H2yV49M5FUFUBPgUFMAns3Rxr3V+NzpOkA5OOA02pRiouALSLjDCAcSMwGl2XnMhMmCBLAP1qCsbhb4zMNqpbd4zGXu7gpJBs8BWJdtuBHTD8uAFhyc8tve4YpSDTMA1CWx+gIXAYGYE/snOay8EmYoRoZVcPnpg6nWGa+585Pjgn4+16S6Us40rqrgSQC2inzE1nD5xxn6etyAxmcREO+QTSZRZdw8c6do60g6qB/L7zznJDPFPbrv8BiYd+K/33gixYP0vvx/OfWiHbjv/HYmPr+J3u/Z+5fwl9beW2QkpYFNRCNHN0eE0Pjoce2pB01l+YLTmP43Xw0SpiUX1fMGaueVu5OK83rKc2wgUqUTMuvXS6yBASpk8eYja3GUyhBRjah84wosvPod1t71rYWti6sF28pmSsm0BCiG6OTqcmmPDMYSobBxk9USbSrLcyextZ70N+E0UUSIZiFRuXX8dFiBQkEK9N0pkkAvo7l4092WPDRx+W9/ShTctXP30/lymDARAIUQ3R4dTc2w4hhAFWFhGns5SO4vSktGCGPxmod9K7AEi4OLWy65jhjBGEUhAAj1DeIPN1e2p9lnzly1gyeqnQXYGApUQopujw6k5NhxDiAJcUcUYRbkiKgJ3QDXJ92BdgNgjCAEMWLYCOGHmIW0EHrH5mILOKludvOLZKzsLVy5OZbsTkBxCdHP0YG6ODccQogBXABkswKAKFVtSzXbHaD7y5w0YHDARMJBlXof4E+Z64z5JJZANWrZmRRFiiDYOIWr82BDN0UMhhCj+ygZlg5hlM0MVsC2pwGTgUsxLA3YAEtAr+asW38JeKbktk4CYU1ZXTxeLVi1RLpNDiBo/NuQT44cVYsTZ5IqtEINjPTqnLCoCDMZGRoAFZFsk8/ZGYQLwHGAr5i1YSQKsuqUIyNkqump53tPPcE7W+MiQj48dEsjOVlEvcr1RD7XofY8erd21vxnD/EYmyM6GlIUBg1KWswkxmL6u/PIF3T6jALZhdVkgCEYtydMybYLqOec53X09RVdPg+bIwTx14mjomtNwUUSlMqWj+0biwd1Hd7z6itUvO/v560ZefNPvL7nymVMrLlk1nfu6chQ4ZYlKDMag0ang7w50L9myu3FRYelmwUJgB7AHGDSMCcrGnEbtyOFDy5avWXnZsaF9N7Zao3PK6eSxx47o8BPHvP/PB/O+hw/EkcHxHw1tWTjCe17B4PH4yc/+vveO7z/WnS9c2g6r55ea33AFjbaC/jJWePtwrdw3EWv1yFrduv6jgLBAgJlhZFCM1HPBydoUJybHr5ueLD812ZwqO61OnJ6cBuRaowhd3fVXjew5tGV6+Vnx3v/4UHrWiva3p0u9tlWqU4uO9UiwcTtBaakRXdajC8O3CiAYxCkGDJgZNvsPDRY7tj1ULl68ZHN3X+PmEFQoyI3ehoHg7CfKdvp178qlDF+wzmuWd6gFXu/o0FX4chsMHUTsCUhyhWDA5pxgKUtOMgk7g/2Rzbfw4ftuYdWLzmS8OV6e1b+KJasWHizq8WSIAUk4O+eUMXzd2VNKnbj1VW/ONqFVqjS8JpvrDZNADQiGnE0yGIOkpeIpvLP/cmbNkdlreZEg2YrITZlnAwcs6Wsf+67PfPRBwBKyAclnAx8EXQkstgGBABsCT0EYYYQLRA2DURJGcAdwAIgL9gZf9ek3MMuWqUSs3aD3AWuAq4XvlP2QcUt4QDyJDeddDrIAA6swO40aiIr3yzzXMAGo7uCO22x6fDNrbtiGLWZJIgCJig3CwWKxzFTgyYgZ4pQViC5BwgbzYaMJUAS5HTKbHt/MjJ0b1yKZWa4kQEAEApCBw0Cz4ClJYCqrAVlEzF0S3wYCdjIiSpxu58a1/E3/DdvAGEiSsZkhwAVPxmCZGbLOt4zsRxDX2iBsKsJ8cee9/DsDG9fyL5hK4MkIMMbMGJGZBt6AOSGIFjawade9/H/9H50/6ZWm+VSWAAAAAElFTkSuQmCC";const i={class:"q-pa-sm q-pl-md row items-center"},c=(0,s.Lk)("img",{src:r},null,-1),d=(0,s.Lk)("span",{class:"q-ml-sm"},[(0,s.Lk)("strong",null," NER Annotator ")],-1),u={class:"q-ml-sm"},p={key:0,style:{color:"rgb(207, 255, 207)"}},h={key:1,style:{color:"rgb(255, 255, 128)"}},g={key:2,style:{color:"rgb(207, 255, 207)"}},m={class:"q-ml-md cursor-pointer non-selectable"},k=(0,s.Lk)("span",null," File ",-1),b={class:"q-ml-md cursor-pointer non-selectable"},y=(0,s.Lk)("span",null," Annotations ",-1),f={class:"q-ml-md cursor-pointer non-selectable"},v=(0,s.Lk)("span",null," Tags ",-1),A={class:"q-ml-md cursor-pointer non-selectable"},S=(0,s.Lk)("span",null,"Help",-1),C=(0,s.Lk)("div",{class:"text-h6"},"Project Name",-1);function w(e,t,n,a,l,r){const w=(0,s.g2)("q-avatar"),x=(0,s.g2)("q-item-section"),L=(0,s.g2)("q-item"),F=(0,s.g2)("q-list"),T=(0,s.g2)("q-menu"),q=(0,s.g2)("export-annotations"),E=(0,s.g2)("q-space"),B=(0,s.g2)("q-icon"),D=(0,s.g2)("q-separator"),P=(0,s.g2)("about-dialog"),N=(0,s.g2)("q-header"),I=(0,s.g2)("q-card-section"),R=(0,s.g2)("q-input"),H=(0,s.g2)("q-btn"),O=(0,s.g2)("q-card-actions"),U=(0,s.g2)("q-card"),W=(0,s.g2)("q-dialog"),Q=(0,s.g2)("exit-dialog"),j=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(N,{bordered:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",i,[(0,s.Lk)("div",null,[(0,s.bF)(w,{size:"xs"},{default:(0,s.k6)((()=>[c])),_:1}),d]),(0,s.Lk)("div",null,[(0,s.Lk)("span",u,["annotate"===e.$store.state.currentPage?((0,s.uX)(),(0,s.CE)("strong",p," | Annotation Mode | ")):"review"===e.$store.state.currentPage?((0,s.uX)(),(0,s.CE)("strong",h," | Review Mode | ")):((0,s.uX)(),(0,s.CE)("strong",g," | ISSUE WITH MENU BAR AND CURENT PAGE | "))])]),(0,s.Lk)("div",m,[k,(0,s.bF)(T,{style:{"border-radius":"0.5rem"}},{default:(0,s.k6)((()=>[(0,s.bF)(F,{dense:"",style:{"min-width":"100px"}},{default:(0,s.k6)((()=>[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",onClick:t[1]||(t[1]=t=>e.pendingClick=e.$refs.file)},{default:(0,s.k6)((()=>[(0,s.bF)(x,null,{default:(0,s.k6)((()=>[(0,s.eW)("Open File")])),_:1}),(0,s.Lk)("input",{onChange:t[0]||(t[0]=(...e)=>r.openFile&&r.openFile(...e)),type:"file",ref:"file",accept:".txt",style:{display:"none"}},null,544)])),_:1})),[[j]])])),_:1})])),_:1})]),(0,s.Lk)("div",b,[y,(0,s.bF)(T,{style:{"border-radius":"0.5rem"}},{default:(0,s.k6)((()=>[(0,s.bF)(F,{dense:"",style:{"min-width":"100px"}},{default:(0,s.k6)((()=>[(0,s.bF)(q),(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",onClick:t[3]||(t[3]=t=>e.pendingClick=e.$refs.file)},{default:(0,s.k6)((()=>[(0,s.bF)(x,null,{default:(0,s.k6)((()=>[(0,s.eW)("Import")])),_:1}),(0,s.Lk)("input",{onChange:t[2]||(t[2]=(...e)=>r.importAnnotations&&r.importAnnotations(...e)),type:"file",ref:"file",accept:".json",style:{display:"none"}},null,544)])),_:1})),[[j]])])),_:1})])),_:1})]),(0,s.Lk)("div",f,[v,(0,s.bF)(T,{style:{"border-radius":"0.5rem"}},{default:(0,s.k6)((()=>[(0,s.bF)(F,{dense:"",style:{"min-width":"100px"}},{default:(0,s.k6)((()=>[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",onClick:t[4]||(t[4]=e=>r.exportTags())},{default:(0,s.k6)((()=>[(0,s.bF)(x,null,{default:(0,s.k6)((()=>[(0,s.eW)("Export")])),_:1})])),_:1})),[[j]]),(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",onClick:t[6]||(t[6]=t=>e.$refs.file.click())},{default:(0,s.k6)((()=>[(0,s.bF)(x,null,{default:(0,s.k6)((()=>[(0,s.eW)("Import")])),_:1}),(0,s.Lk)("input",{onChange:t[5]||(t[5]=(...e)=>r.importTags&&r.importTags(...e)),type:"file",ref:"file",accept:".json",style:{display:"none"}},null,544)])),_:1})),[[j]])])),_:1})])),_:1})]),(0,s.bF)(E),(0,s.bF)(B,{style:{"margin-top":"5px"},color:"white",name:e.$q.dark.isActive?"fas fa-sun":"fas fa-moon",class:"cursor-pointer",onClick:r.toggleDarkMode},null,8,["name","onClick"]),(0,s.Lk)("div",A,[S,(0,s.bF)(T,{style:{"border-radius":"0.5rem"}},{default:(0,s.k6)((()=>[(0,s.bF)(F,{dense:"",style:{"min-width":"100px"}},{default:(0,s.k6)((()=>[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",href:"https://github.com/tecoholic/ner-annotator/discussions",target:"_blank"},{default:(0,s.k6)((()=>[(0,s.bF)(x,null,{default:(0,s.k6)((()=>[(0,s.eW)(" Forum ")])),_:1})])),_:1})),[[j]]),(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",href:"https://github.com/tecoholic/ner-annotator/issues",target:"_blank"},{default:(0,s.k6)((()=>[(0,s.eW)(" Report Issue ")])),_:1})),[[j]]),(0,s.bF)(D),(0,s.bo)(((0,s.uX)(),(0,s.Wv)(L,{clickable:"",onClick:t[7]||(t[7]=t=>e.showAbout=!0)},{default:(0,s.k6)((()=>[(0,s.bF)(x,null,{default:(0,s.k6)((()=>[(0,s.eW)("About")])),_:1})])),_:1})),[[j]])])),_:1})])),_:1}),(0,s.bF)(P,{show:e.showAbout,onHide:t[8]||(t[8]=t=>e.showAbout=!1)},null,8,["show"])])])])),_:1}),(0,s.bF)(W,{modelValue:e.promptForProject,"onUpdate:modelValue":t[11]||(t[11]=t=>e.promptForProject=t),persistent:""},{default:(0,s.k6)((()=>[(0,s.bF)(U,{style:{"min-width":"350px"}},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[C])),_:1}),(0,s.bF)(I,{class:"q-pt-none"},{default:(0,s.k6)((()=>[(0,s.bF)(R,{dense:"",modelValue:e.newProjectName,"onUpdate:modelValue":t[9]||(t[9]=t=>e.newProjectName=t),autofocus:"",onKeyup:t[10]||(t[10]=(0,o.jR)((t=>e.promptForProject=!1),["enter"]))},null,8,["modelValue"])])),_:1}),(0,s.bF)(O,{align:"right",class:"text-primary"},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.bF)(H,{flat:"",label:"Cancel"},null,512),[[j]]),(0,s.bo)((0,s.bF)(H,{flat:"",label:"Create Project"},null,512),[[j]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,s.bF)(Q,{show:null!=e.pendingClick,onHide:t[12]||(t[12]=t=>e.pendingClick=null),onConfirm:t[13]||(t[13]=t=>e.pendingClick.click())},null,8,["show"])],64)}function x(e,t,n,o,a,l){const r=(0,s.g2)("q-item-section"),i=(0,s.g2)("q-item"),c=(0,s.gN)("close-popup");return(0,s.bo)(((0,s.uX)(),(0,s.Wv)(i,{clickable:"",onClick:t[0]||(t[0]=e=>l.promptForNameAndExport())},{default:(0,s.k6)((()=>[(0,s.bF)(r,null,{default:(0,s.k6)((()=>[(0,s.eW)("Export")])),_:1})])),_:1})),[[c]])}n(622);var L=n(3937),F=n(432),T=n(4377),q=n(2750);const E=async(e,t)=>{if("undefined"===typeof window.rpc){let n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}else(0,F.U)({defaultPath:await(0,q.$c)(),filters:[{extensions:["json"],name:"JSON Files (*.json)"},{name:"All files (*.*)",extensions:["*"]}]}).then((t=>{t&&(t.match(/.*\.json$/)||(t+=".json"),(0,T.lA)("save_file",{filepath:t,contents:e}).then((e=>alert(e))).catch((e=>alert(e))))})).catch((e=>console.log("Save cancelled.",e)))};var B={name:"ExportAnnotations",computed:{...(0,L.aH)(["annotations","classes"])},methods:{promptForNameAndExport(){const e=prompt("Please enter your name for the annotations export:");e?this.generateJSONExport(e):console.log("Export cancelled or name not provided.")},async generateJSONExport(e){const t={classes:this.classes.map(((e,t)=>({id:t+1,name:e.name,color:e.color}))),annotations:this.annotations.map((t=>[t.text,{entities:t.entities.map((t=>{let n=t[9]||[];const o=2===t[5]?"Rejected":1===t[5]?"Accepted":"Suggested",s=[o,this.formatDate(new Date),e,t[3]];return n.push(s),[t[1],t[2],n.map((e=>[e[0],e[1],e[2],e[3]]))]}))}]))},n=JSON.stringify(t,null,2);try{await E(n,`${e}-annotations.json`),console.log("Export successful")}catch(o){console.error("Export failed:",o)}},formatDate(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return`${t}-${n}-${o}~${s}:${a}:${l}`}}},D=n(1317),P=n(8070),N=n(3787),I=n(4282),R=n(2110),H=n.n(R);const O=(0,D.A)(B,[["render",x]]);var U=O;H()(B,"components",{QItem:P.A,QItemSection:N.A}),H()(B,"directives",{ClosePopup:I.A});var W=n(507);const Q=(0,s.Lk)("div",{class:"text-h6"},"NER Annotator",-1),j=(0,s.Lk)("strong",null,"Version: ",-1),X=(0,s.Lk)("p",null,[(0,s.Lk)("strong",null,"Source: "),(0,s.Lk)("a",{href:"https://github.com/tecoholic/ner-annotator"}," Github Repository ")],-1),_=(0,s.Lk)("p",null,[(0,s.Lk)("strong",null,"Author:"),(0,s.eW)(" @tecoholic ("),(0,s.Lk)("a",{href:"https://github.com/tecoholic"},"Github"),(0,s.eW)(", "),(0,s.Lk)("a",{href:"https://github.com/tecoholic"},"Twitter"),(0,s.eW)(") ")],-1);function $(e,t,n,o,l,r){const i=(0,s.g2)("q-card-section"),c=(0,s.g2)("q-btn"),d=(0,s.g2)("q-card-actions"),u=(0,s.g2)("q-card"),p=(0,s.g2)("q-dialog"),h=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.Wv)(p,{"model-value":n.show,onHide:t[0]||(t[0]=t=>e.$emit("hide"))},{default:(0,s.k6)((()=>[(0,s.bF)(u,{style:{"min-width":"400px",padding:"10px","border-radius":"10px"}},{default:(0,s.k6)((()=>[(0,s.bF)(i,null,{default:(0,s.k6)((()=>[Q])),_:1}),(0,s.bF)(i,{class:"q-pt-none"},{default:(0,s.k6)((()=>[(0,s.Lk)("p",null,[j,(0,s.eW)((0,a.v_)(e.version),1)]),X,_])),_:1}),(0,s.bF)(d,{align:"right"},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.bF)(c,{flat:"",label:"OK",color:"primary"},null,512),[[h]])])),_:1})])),_:1})])),_:1},8,["model-value"])}var z={name:"AboutDialog",emits:["hide"],props:{show:{type:Boolean,default:!1}},data:function(){return{version:"1.3.0"}}},K=n(1078),G=n(7422),M=n(3507),V=n(1667),Y=n(6046);const J=(0,D.A)(z,[["render",$]]);var Z=J;H()(z,"components",{QDialog:K.A,QCard:G.A,QCardSection:M.A,QCardActions:V.A,QBtn:Y.A}),H()(z,"directives",{ClosePopup:I.A});const ee=(0,s.Lk)("div",{class:"text-h5"},"Are you sure you want to close this file?",-1),te=(0,s.Lk)("p",null,"All changes made to this file will be lost.",-1);function ne(e,t,n,o,a,l){const r=(0,s.g2)("q-card-section"),i=(0,s.g2)("q-btn"),c=(0,s.g2)("q-card-actions"),d=(0,s.g2)("q-card"),u=(0,s.g2)("q-dialog"),p=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.Wv)(u,{"model-value":n.show,onHide:t[2]||(t[2]=t=>e.$emit("hide"))},{default:(0,s.k6)((()=>[(0,s.bF)(d,{style:{"max-width":"400px",padding:"10px","border-radius":"10px"}},{default:(0,s.k6)((()=>[(0,s.bF)(r,null,{default:(0,s.k6)((()=>[ee])),_:1}),(0,s.bF)(r,{class:"text-body1"},{default:(0,s.k6)((()=>[te,(0,s.eW)(" If you haven't exported the annotations, please do so before closing the file. ")])),_:1}),(0,s.bF)(c,{align:"right"},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.bF)(i,{flat:"",label:"Cancel",color:"red",onClick:t[0]||(t[0]=t=>e.$emit("hide"))},null,512),[[p]]),(0,s.bo)((0,s.bF)(i,{flat:"",label:"OK",color:"light-blue",onClick:t[1]||(t[1]=t=>e.$emit("confirm"))},null,512),[[p]])])),_:1})])),_:1})])),_:1},8,["model-value"])}var oe={name:"ExitDialog",emits:["hide","confirm"],props:{show:{type:Boolean,default:!1}}};const se=(0,D.A)(oe,[["render",ne]]);var ae=se;H()(oe,"components",{QDialog:K.A,QCard:G.A,QCardSection:M.A,QCardActions:V.A,QBtn:Y.A}),H()(oe,"directives",{ClosePopup:I.A});var le={components:{ExportAnnotations:U,AboutDialog:Z,ExitDialog:ae},name:"MenuBar",setup(){const e=(0,W.A)();return{notify(t,n,o){e.notify({icon:t,message:n,color:o,position:"top",timeout:2e3,actions:[{label:"Dismiss",color:"white"}]})}}},data:function(){return{promptForProject:!1,newProjectName:"",showAbout:!1,pendingClick:null}},computed:{...(0,L.aH)(["annotations","classes"])},methods:{...(0,L.PY)(["loadClasses","loadAnnotations","setInputSentences","clearAllAnnotations","resetIndex"]),exportTags:async function(){await E(JSON.stringify(this.classes),"tags.json")},importTags:function(e){let t=e.target.files[0],n=new FileReader;n.onload=t=>{try{this.loadClasses(JSON.parse(t.target.result)),this.notify("fa fa-check",`${this.classes.length} Tags imported successfully`,"positive")}catch(e){this.notify("fas fa-exclamation-circle","Invalid file","red-6")}},n.readAsText(t)},openFile:function(e){let t=e.target.files[0],n=new FileReader;n.onload=e=>{this.setInputSentences(e.target.result),this.clearAllAnnotations()},n.readAsText(t),this.resetIndex()},importAnnotations:function(e){let t=e.target.files[0],n=new FileReader;n.onload=t=>{try{this.loadAnnotations(JSON.parse(t.target.result)),this.notify("fa fa-check","Annotations imported successfully","positive")}catch(e){this.notify("fas fa-exclamation-circle","Invalid file","red-6")}},n.readAsText(t)},toggleDarkMode:function(){this.$q.dark.toggle()}}},re=n(9986),ie=n(1450),ce=n(5495),de=n(3117),ue=n(2742),pe=n(3870),he=n(2596),ge=n(9468);const me=(0,D.A)(le,[["render",w]]);var ke=me;H()(le,"components",{QHeader:re.A,QAvatar:ie.A,QMenu:ce.A,QList:de.A,QItem:P.A,QItemSection:N.A,QSpace:ue.A,QIcon:pe.A,QSeparator:he.A,QDialog:K.A,QCard:G.A,QCardSection:M.A,QInput:ge.A,QCardActions:V.A,QBtn:Y.A}),H()(le,"directives",{ClosePopup:I.A});var be=n.p+"img/step-1.4f5d4ae3.png",ye=n.p+"img/step-2.ada325d3.png",fe=n.p+"img/step-3.7e65646c.png";const ve={class:"q-mx-auto q-my-xl",style:{"max-width":"600px"}},Ae=(0,s.Lk)("h5",{class:"text-h4 q-mb-sm"},"NER Text Annotator",-1),Se={class:"q-my-xl q-py-md",style:{"margin-top":"7rem"}},Ce={class:"q-mx-auto",style:{"max-width":"600px"}},we=(0,s.Lk)("h4",{class:"text-h4"}," How do I use the NER Annotator? ",-1),xe=(0,s.Lk)("p",{class:"text-subtitle1 q-my-md"},"Tips to prepare the text file",-1),Le=(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,"Break your content in paragraphs or passages"),(0,s.Lk)("li",null,[(0,s.eW)(" Maintain a consistent seperator between the passages. "),(0,s.Lk)("br"),(0,s.eW)(" Eg., newline, empty line or a text seperator like "),(0,s.Lk)("code",null,"---")]),(0,s.Lk)("li",null," For large datasets, break the text into smaller files and tag them seperately ")],-1),Fe=(0,s.Lk)("ul",{class:"q-my-md"},[(0,s.Lk)("li",null,[(0,s.eW)("Use the "),(0,s.Lk)("strong",null,"New Tag"),(0,s.eW)(" button to create new tags")]),(0,s.Lk)("li",null,[(0,s.eW)(" Use the "),(0,s.Lk)("strong",null,"Edit Tag"),(0,s.eW)(" button to remove unwanted tags ")]),(0,s.Lk)("li",null,[(0,s.eW)(" Click the "),(0,s.Lk)("strong",null,"Save"),(0,s.eW)(" button once you are done annotating an entry and to move to the next one ")]),(0,s.Lk)("li",null,[(0,s.eW)(" Adjust the "),(0,s.Lk)("strong",null,"Text Seperator"),(0,s.eW)(" break your content correctly into entries ")]),(0,s.Lk)("li",null,[(0,s.eW)(" Use the "),(0,s.Lk)("strong",null,"Tags"),(0,s.eW)(" menu to Export/Import tags to share with your team ")])],-1);function Te(e,t,n,o,l,r){const i=(0,s.g2)("q-icon"),c=(0,s.g2)("q-file"),d=(0,s.g2)("q-separator"),u=(0,s.g2)("q-img"),p=(0,s.g2)("q-timeline-entry"),h=(0,s.g2)("q-timeline");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(i,{name:e.$q.dark.isActive?"fas fa-sun":"fas fa-moon",class:(0,a.C4)([e.$q.dark.isActive?"text-white":"text-black","cursor-pointer fixed-top-right q-mx-xl q-my-lg text-h5"]),onClick:r.toggleDarkMode},null,8,["name","class","onClick"]),(0,s.Lk)("div",ve,[Ae,(0,s.Lk)("p",{class:(0,a.C4)(["text-subtitle1",e.$q.dark.isActive?"text-grey-4":"text-grey-7"])}," Annotate text for spaCy NER Model training ",2),(0,s.Lk)("div",Se,[(0,s.bF)(c,{modelValue:l.textFile,"onUpdate:modelValue":[t[0]||(t[0]=e=>l.textFile=e),r.onFileSelected],accept:".txt,.json",onRejected:r.fileSelectionError,filled:"",label:"Open a text or json file to begin","bg-color":e.$q.dark.isActive?"black-1":"light-blue-1"},{prepend:(0,s.k6)((()=>[(0,s.bF)(i,{name:"fas fa-upload"})])),_:1},8,["modelValue","onRejected","onUpdate:modelValue","bg-color"]),(0,s.Lk)("p",{class:(0,a.C4)(["text-subtitle1 q-my-md",e.$q.dark.isActive?"text-grey-4":"text-grey-7"])}," Hint: You can also drag and drop files into this window! ",2)])]),(0,s.bF)(d),(0,s.Lk)("div",{class:(0,a.C4)([e.$q.dark.isActive?"bg-dark":"bg-grey-1","q-pa-lg"])},[(0,s.Lk)("div",Ce,[we,(0,s.bF)(h,null,{default:(0,s.k6)((()=>[(0,s.bF)(p,{subtitle:"Step 1",title:"Load your text file with contents to annotate",icon:"fa fa-upload",color:"yellow-8"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{src:be,"spinner-color":"white",class:"rounded-borders",style:{border:"1px solid #ccc",width:"80%"}}),xe,Le])),_:1}),(0,s.bF)(p,{subtitle:"Step 2",title:"Create some tags and start tagging your text",icon:"fa fa-tag",color:"orange-6"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{src:ye,"spinner-color":"white",class:"rounded-borders",style:{border:"1px solid #ccc"}}),Fe])),_:1}),(0,s.bF)(p,{subtitle:"Step 3",title:"Download your annotations as a JSON file that can be used for training",icon:"fa fa-download",color:"red-6"},{default:(0,s.k6)((()=>[(0,s.bF)(u,{src:fe,"spinner-color":"white",class:"rounded-borders",style:{border:"1px solid #ccc",width:"70%"}})])),_:1}),(0,s.bF)(p,{subtitle:"Finally",title:"Convert to DocBin format and use it for training",icon:"fa fa-file",color:"red-10"},{default:(0,s.k6)((()=>[(0,s.Lk)("p",null,[(0,s.eW)(" See the spaCy documentation "),(0,s.Lk)("a",{class:(0,a.C4)(e.$q.dark.isActive?"text-light-blue-4":"text-dark-blue"),href:"https://spacy.io/api/data-formats#json-input"}," here ",2),(0,s.eW)(" on how to convert the annotations from JSON to DocBin format. ")])])),_:1})])),_:1})])],2)],64)}var qe={name:"StartPage",emits:["text-file-loaded","json-file-loaded"],data(){return{textFile:null}},methods:{...(0,L.PY)(["setInputSentences"]),onFileSelected(e){let t=e.name.split(".").pop();try{let n=new FileReader;n.readAsText(e),n.addEventListener("load",(e=>{this.setInputSentences(e.target.result),"txt"===t?this.$emit("text-file-loaded"):"json"===t?(console.log("Emitting json-file-loaded"),this.$emit("json-file-loaded")):alert("Please upload either a .txt or a .json file.")}))}catch(n){console.log("Catch reached"),this.fileSelectionError()}},fileSelectionError(){this.$q.notify({icon:"fas fa-exclamation-circle",message:"Invalid file",color:"red-6",position:"top",timeout:2e3,actions:[{label:"Dismiss",color:"white"}]})},toggleDarkMode(){this.$q.dark.toggle()}}},Ee=n(3901),Be=n(4718),De=n(7616),Pe=n(5726);const Ne=(0,D.A)(qe,[["render",Te]]);var Ie=Ne;H()(qe,"components",{QIcon:pe.A,QFile:Ee.A,QSeparator:he.A,QTimeline:Be.A,QTimelineEntry:De.A,QImg:Pe.A});const Re={class:"q-pa-lg",style:{height:"60vh","overflow-y":"scroll"}},He={class:"q-pa-md",style:{"border-top":"1px solid #ccc"}},Oe={class:"q-pa-md",style:{"border-top":"1px solid #ccc"}};function Ue(e,t,n,o,a,l){const r=(0,s.g2)("classes-block"),i=(0,s.g2)("q-btn");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(r),(0,s.Lk)("div",Re,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.tm.tokens,(e=>((0,s.uX)(),(0,s.Wv)((0,s.$y)("token"===e.type?"Token":"TokenBlock"),{key:e.start,token:e,backgroundColor:e.backgroundColor,humanOpinion:e.humanOpinion,onRemoveBlock:l.onRemoveBlock,onReplaceBlockLabel:l.onReplaceBlockLabel},null,40,["token","backgroundColor","humanOpinion","onRemoveBlock","onReplaceBlockLabel"])))),128))]),(0,s.Lk)("div",He,[(0,s.bF)(i,{class:"q-mx-sm",color:"primary",outline:"",title:"Undo",onClick:l.undo,label:"Undo"},null,8,["onClick"])]),(0,s.Lk)("div",Oe,[(0,s.bF)(i,{color:"red",outline:"",class:"q-mx-sm",title:"Delete all annotations for all sentences/paragraphs",onClick:l.resetBlocks,label:"Reset"},null,8,["onClick"]),(0,s.bF)(i,{class:"q-mx-sm",color:e.$q.dark.isActive?"grey-3":"grey-9",outline:"",title:"Go back one sentence/paragraph",onClick:l.backOneSentence,disabled:0==e.currentIndex,label:"Back"},null,8,["color","onClick","disabled"]),(0,s.bF)(i,{class:"q-mx-sm",color:e.$q.dark.isActive?"grey-3":"grey-9",outline:"",title:"Go forward one sentence/paragraph",onClick:l.skipCurrentSentence,label:"Skip"},null,8,["color","onClick"]),(0,s.bF)(i,{class:"q-mx-sm",color:"green-7",outline:"",title:"Go forward one sentence/paragraph",onClick:l.saveTags,label:"Save"},null,8,["onClick"])])])}const We=["id"];function Qe(e,t,n,o,l,r){return"token"===n.token.type?((0,s.uX)(),(0,s.CE)("span",{key:0,id:"t"+n.token.start,class:"token",style:(0,a.Tr)({padding:"char"==this.$store.state.annotationPrecision?"0.25rem 0rem":"0.25rem"})},(0,a.v_)(" "==n.token.text?"Â ":n.token.text),13,We)):(0,s.Q3)("",!0)}var je={name:"Token",props:{token:{type:Object,required:!0}}};const Xe=(0,D.A)(je,[["render",Qe]]);var _e=Xe;const $e={class:"tag"};function ze(e,t,n,l,r,i){const c=(0,s.g2)("Token"),d=(0,s.g2)("q-btn");return(0,s.uX)(),(0,s.CE)("mark",{class:(0,a.C4)(["bg-"+n.backgroundColor,{"shadow-unreviewed":!r.userHasToggled,"bg-red":!n.token.humanOpinion}])},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.token.tokens,(e=>((0,s.uX)(),(0,s.Wv)(c,{key:e.start,token:e},null,8,["token"])))),128)),(0,s.Lk)("span",$e,["review"===this.currentPage?((0,s.uX)(),(0,s.CE)("i",{key:0,class:(0,a.C4)(i.symbolClass),onClick:t[0]||(t[0]=(...e)=>i.toggleSymbol&&i.toggleSymbol(...e))},null,2)):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,a.v_)(n.token.label)+" ",1),(0,s.bF)(d,{icon:"fa fa-exchange-alt",round:"",flat:"",size:"xs","text-color":"grey-7",title:"Change label to currently selected label",onClick:t[1]||(t[1]=e=>i.recordActionAndEmit("replace-block-label",n.token.start))}),(0,s.bF)(d,{icon:"fa fa-times-circle",round:"",flat:"",size:"xs","text-color":"grey-7",title:"Delete annotation",onClick:t[2]||(t[2]=(0,o.D$)((e=>i.recordActionAndEmit("remove-block",n.token.start)),["stop"]))}),"review"===this.currentPage?((0,s.uX)(),(0,s.Wv)(d,{key:1,icon:i.reviewedIconClass,round:"",flat:"",size:"xs","text-color":"grey-9",title:"Dark indicates that you have reviewed this annotation, light means you have not.",onClick:(0,o.D$)(i.toggleReviewed,["stop"])},null,8,["icon","onClick"])):(0,s.Q3)("",!0)])],2)}var Ke={name:"TokenBlock",components:{Token:_e},props:{token:Object,backgroundColor:String,humanOpinion:Boolean,isSymbolActive:{type:Number,default:0}},data(){return{userHasToggled:!1,suggestedState:!1,isReviewed:!1}},computed:{...(0,L.aH)(["currentPage"]),symbolClass(){switch(this.isSymbolActive){case 0:return"fas fa-hourglass-start fa-lg";case 1:return"fas fa-thumbs-up fa-lg";case 2:return"fas fa-skull-crossbones fa-lg";default:return"fas fa-question-circle fa-lg"}},reviewedIconClass(){return this.userHasToggled?"fas fa-toggle-on":"fas fa-toggle-off"}},methods:{toggleSymbol(){this.recordAction("symbol-state",this.isSymbolActive);let e=(this.isSymbolActive+1)%3;this.userHasToggled=!0,this.$emit("update-symbol-state",{tokenStart:this.token.start,newSymbolState:e})},toggleReviewed(){this.recordAction("review-state",this.isReviewed),this.isReviewed=!this.isReviewed,this.userHasToggled=!0},recordAction(e,t){const n={type:e,tokenStart:this.token.start,previousState:t,newState:this["symbol-state"===e?"isSymbolActive":"isReviewed"],timestamp:Date.now()};this.$emit("record-undo",n)},recordActionAndEmit(e,t){this.recordAction(e,this.token),this.$emit(e,t)}}};const Ge=(0,D.A)(Ke,[["render",ze]]);var Me=Ge;H()(Ke,"components",{QBtn:Y.A});const Ve={class:"q-pa-md",style:{"border-bottom":"1px solid #ccc"}},Ye={class:"row"},Je={class:"tags"},Ze={class:"q-mx-md"},et={class:"buttons"};function tt(e,t,n,o,l,r){const i=(0,s.g2)("q-avatar"),c=(0,s.g2)("q-chip"),d=(0,s.g2)("q-space"),u=(0,s.g2)("q-btn"),p=(0,s.g2)("q-input");return(0,s.uX)(),(0,s.CE)("div",Ve,[(0,s.Lk)("div",Ye,[(0,s.Lk)("div",Je,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.classes,((t,n)=>((0,s.uX)(),(0,s.Wv)(c,{key:t.id,outline:"",square:"",style:{height:"2rem"},color:t.color.replace("11","12"),clickable:"",onClick:t=>e.setCurrentClass(n),removable:l.showDeleteButtons,onRemove:e=>r.handleRemoveClass(t.id,t.name)},{default:(0,s.k6)((()=>[t.id===e.currentClass.id?((0,s.uX)(),(0,s.Wv)(i,{key:0,color:t.color.replace("11","12"),style:{height:"2rem"},"text-color":"white",icon:"fa fa-check"},null,8,["color"])):(0,s.Q3)("",!0),t.id!==e.currentClass.id?((0,s.uX)(),(0,s.Wv)(i,{key:1,color:t.color.replace("11","12"),style:{height:"2rem"},"text-color":"white","font-size":"16px"},{default:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(n+1),1)])),_:2},1032,["color"])):(0,s.Q3)("",!0),(0,s.Lk)("p",{class:(0,a.C4)(["q-mb-none",e.$q.dark.isActive?"text-grey-3":"text-grey-9"])},(0,a.v_)(t.name),3)])),_:2},1032,["color","onClick","removable","onRemove"])))),128))]),(0,s.bF)(d),(0,s.Lk)("div",Ze,[l.showNewClassInput||0===e.classes.length?((0,s.uX)(),(0,s.Wv)(p,{key:0,"bottom-slots":"",modelValue:l.newClassName,"onUpdate:modelValue":t[1]||(t[1]=e=>l.newClassName=e),hint:"Enter a NER Tag and click [+] to add it",dense:"",autofocus:""},{append:(0,s.k6)((()=>[(0,s.bF)(u,{round:"",dense:"",flat:"",color:"green-4",icon:"fa fa-plus",onClick:r.saveNewClass},null,8,["onClick"]),(0,s.bF)(u,{round:"",color:"red-4",dense:"",flat:"",icon:"fa fa-times",onClick:t[0]||(t[0]=e=>l.showNewClassInput=!1)})])),_:1},8,["modelValue"])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",et,["review"!==e.$store.state.currentPage?((0,s.uX)(),(0,s.Wv)(u,{key:0,outline:"",onClick:t[2]||(t[2]=e=>l.showNewClassInput=!0),label:"New Tag",class:"q-mr-sm",color:e.$q.dark.isActive?"grey-3":"grey-9"},null,8,["color"])):(0,s.Q3)("",!0),"review"!==e.$store.state.currentPage?((0,s.uX)(),(0,s.Wv)(u,{key:1,outline:"",onClick:t[3]||(t[3]=e=>l.showDeleteButtons=!l.showDeleteButtons),label:l.showDeleteButtons?"Lock Tags":"Edit Tags",color:e.$q.dark.isActive?"grey-3":"grey-9"},null,8,["label","color"])):(0,s.Q3)("",!0)])])])}var nt={name:"ClassesBlock",data(){return{showNewClassInput:!1,newClassName:"",showDeleteButtons:!1}},computed:{...(0,L.aH)(["classes","currentClass","enableKeyboardShortcuts"])},created(){document.addEventListener("keydown",this.keypress)},watch:{newClassName(e,t){e!=t&&(this.newClassName=e.toUpperCase())}},methods:{...(0,L.PY)(["setCurrentClass"]),...(0,L.i0)(["createNewClass","deleteClass"]),keypress(e){if(this.enableKeyboardShortcuts){var t=parseInt(e.key);t&&(t>this.classes.length||this.setCurrentClass(t-1))}},handleRemoveClass(e,t){let n=confirm("Are you sure you want to remove the tag `"+t+"`?\nNOTE: This will NOT affect previously tagged entities.");n&&this.deleteClass(e)},saveNewClass(){if(!this.newClassName)return;const e=this;this.createNewClass(this.newClassName).then((()=>{e.showNewClassInput=!1,e.newClassName=""}))},onInputKeyup(e){"Enter"===e.key&&this.saveNewClass()}}},ot=n(8026);const st=(0,D.A)(nt,[["render",tt],["__scopeId","data-v-52bae72a"]]);var at=st;H()(nt,"components",{QChip:ot.A,QAvatar:ie.A,QSpace:ue.A,QInput:ge.A,QBtn:Y.A});class lt{constructor(e){this.classes=e,this.tokens=[]}getTokenByStart(e){return this.tokens.find((t=>t.start===e))}setTokensAndAnnotation(e,t){if(this.tokens=e.map((e=>({type:"token",start:e[0],end:e[1],text:e[2],humanOpinion:!0,isSymbolActive:0}))),this.words=e.map((e=>e[2])),void 0!=t)for(let l=0;l<t.entities.length;l++){var n=t.entities[l][1],o=t.entities[l][2],s=t.entities[l][3];console.log("ENTITYNAME: ",s,t.entities[l]);var a=this.classes.find((e=>e.name.toUpperCase()===s.toUpperCase()));console.log("SETTOKENENTITYCLSAS: ",a),a||(a={name:s}),this.addNewBlock(n,o,a,!0)}}addNewBlock(e,t,n,o,s=!1,a,l="name",r="suggested",i,c=!0,d=0){let u={type:"token-block",annotationHistory:i,start:e,end:t,name:l,label:n.name,humanOpinion:!0,initiallyNLP:s,userHasToggled:c,isSymbolActive:d,isSuggested:!1,isLoaded:a,status:r,tokens:this.tokens.filter((n=>n.start>=e&&n.end<=t)),backgroundColor:n.color||null},p=[],h=[],g=t<e?t:e,m=t>e?t:e;for(let b=0;b<this.tokens.length;b++){let e=this.tokens[b];if(e.end<g)h.push(e);else if(e.end>g&&e.start<m)if("token-block"==e.type)if(e.label.toUpperCase()==n.name.toUpperCase())p.push(...e.tokens);else{let t=[],o=[],s=e.tokens;for(let e=0;e<s.length;e++){let n=s[e];n.end<=g?t.push(n):n.end>g&&n.start<m?p.push(n):n.start>=m&&o.push(n)}k(t,e,h),k(p,n,h,!0),k(o,e,h),p=[]}else"token"==e.type&&p.push(e);else e.start>=m&&p.length?(k(p,n,h,!0),p=[],h.push(e)):h.push(e)}function k(e,t,n,o=!1){if(e.length){let c={type:"token-block",start:e[0].start,end:e[e.length-1].end,name:l,tokens:e,humanOpinion:!0,label:t.name,classId:t.id||0,backgroundColor:t.color||null,initiallyNLP:!!o&&s,userHasToggled:!0,isSymbolActive:d,isLoaded:a,status:r,annotationHistory:i};n.push(c)}}p.length&&(h.push(u),k(p,n,h,!0)),this.tokens=h}removeBlock(e){let t=[];for(let n=0;n<this.tokens.length;n++)"token-block"===this.tokens[n].type&&this.tokens[n].start===e?t.push(...this.tokens[n].tokens):t.push(this.tokens[n]);this.tokens=t}resetBlocks(){let e=[];for(let t=0;t<this.tokens.length;t++)"token"===this.tokens[t].type?e.push(this.tokens[t]):e.push(...this.tokens[t].tokens);this.tokens=e}updateSymbolState(e,t){const n=this.tokens.find((t=>"token-block"===t.type&&t.start===e));n&&(n.isSymbolActive=t,n.userHasToggled=!0)}exportAsAnnotation(){let e=[];for(let t=0;t<this.tokens.length;t++)if("token-block"===this.tokens[t].type){let n=this.tokens[t];console.log("export As annotations this is ",n),e.push([n.name,n.start,n.end,n.label,n.initiallyNLP,n.isSymbolActive,n.userHasToggled,n.isLoaded,n.status,n.annotationHistory])}return e}getBlockByStart(e){for(let t=0;t<this.tokens.length;t++){const n=this.tokens[t];if("token-block"===n.type&&n.start===e)return n}return console.log("Error, Unable to get block by start in token-manager.js"),null}}var rt=lt,it=n(1440),ct=n.n(it),dt={name:"AnnotationPage",data:function(){return{tm:new rt([]),currentSentence:{},redone:"",tokenizer:new(ct()),addedTokensStack:[]}},components:{Token:_e,TokenBlock:Me,ClassesBlock:at},computed:{...(0,L.aH)(["annotations","annotationHistory","classes","currentClass","currentIndex","inputSentences","enableKeyboardShortcuts","annotationPrecision"])},watch:{inputSentences(){this.resetIndex(),this.tokenizeCurrentSentence()},annotations(){this.currentAnnotation!=this.annotations[this.currentIndex]&&this.tokenizeCurrentSentence()},classes(){this.tokenizeCurrentSentence()},annotationPrecision(){this.tokenizeCurrentSentence()}},created(){this.inputSentences.length&&this.tokenizeCurrentSentence(),document.addEventListener("mouseup",this.selectTokens),document.addEventListener("keydown",this.keypress)},beforeUnmount(){document.removeEventListener("mouseup",this.selectTokens),document.removeEventListener("keydown",this.keypress)},methods:{...(0,L.PY)(["nextSentence","previousSentence","resetIndex"]),keypress(e){this.enableKeyboardShortcuts&&(32==e.keyCode?this.saveTags():39==e.keyCode?this.skipCurrentSentence():37==e.keyCode?this.backOneSentence():82!=e.keyCode&&27!=e.keyCode||this.resetBlocks(),e.stopPropagation())},undo(){console.log("Undo Stack:",this.addedTokensStack)},applyAnnotationHistory(){const e=this.annotationHistory;e&&e.length>0&&(e.forEach((e=>{const[t,n,o,,s,,a]=e,l="nlp"!==s,r=this.classes.find((e=>e.name===t));r?this.tm.addNewBlock(n,o,r,l,a,!0,s,status):console.warn(`Label "${t}" not found in classes.`)})),this.tm.tokens.forEach((t=>{if("token-block"===t.type){const n=e.some((e=>{const[,n,o,,s]=e;return"nlp"===s&&t.start===n&&t.end===o}));t.humanOpinion=!n}})))},tokenizeCurrentSentence(){let e,t;if(this.currentSentence=this.inputSentences[this.currentIndex],this.currentAnnotation=this.annotations[this.currentIndex],"char"==this.$store.state.annotationPrecision){e=this.currentSentence.text.split(""),t=[];for(let e=0;e<this.currentSentence.text.length;e++)t.push([e,e+1])}else e=this.tokenizer.tokenize(this.currentSentence.text),t=this.tokenizer.span_tokenize(this.currentSentence.text);let n=e.map(((e,n)=>[t[n][0],t[n][1],e]));this.tm=new rt(this.classes),this.tm.setTokensAndAnnotation(n,this.currentAnnotation),this.applyAnnotationHistory()},selectTokens(){let e=document.getSelection();if(e.anchorOffset===e.focusOffset&&e.anchorNode===e.focusNode)return;const t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);let o,s;try{o=parseInt(t.startContainer.parentElement.id.replace("t",""));let e=parseInt(n.endContainer.parentElement.id.replace("t",""));s=e+n.endOffset}catch{return void console.log("selected text were not tokens")}if(!this.classes.length&&e.anchorNode)return alert("There are no Tags available. Kindly add some Tags before tagging."),void e.empty();console.log("adding manual block ",o,s,this.currentClass),this.tm.addNewBlock(o,s,this.currentClass,!0,!1),this.addedTokensStack.push(o),e.empty()},onRemoveBlock(e){this.tm.removeBlock(e)},onReplaceBlockLabel(e){const t=this.tm.getBlockByStart(e),n=t.start,o=t.end;this.tm.removeBlock(e),void 0!==n&&void 0!==o&&(this.addedTokensStack.push(n),this.tm.addNewBlock(n,o,this.currentClass))},resetBlocks(){this.tm.resetBlocks(),this.addedTokensStack=[]},skipCurrentSentence(){this.nextSentence(),this.tokenizeCurrentSentence()},backOneSentence(){this.previousSentence(),this.tokenizeCurrentSentence()},saveTags(){this.$store.commit("addAnnotation",{text:this.currentSentence.text,entities:this.tm.exportAsAnnotation()}),this.nextSentence(),this.tokenizeCurrentSentence()}}};const ut=(0,D.A)(dt,[["render",Ue]]);var pt=ut;H()(dt,"components",{QBtn:Y.A});const ht={class:"q-pa-lg",style:{height:"60vh","overflow-y":"scroll"}},gt={class:"q-pa-md",style:{"border-top":"1px solid #ccc"}},mt={class:"q-pa-md",style:{"border-top":"1px solid #ccc"}};function kt(e,t,n,o,l,r){const i=(0,s.g2)("classes-block"),c=(0,s.g2)("q-btn");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(i),(0,s.Lk)("div",ht,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.tm.tokens,(e=>((0,s.uX)(),(0,s.Wv)((0,s.$y)("token"===e.type?"Token":"TokenBlock"),{key:`${e.type}-${e.start}`,token:e,class:(0,a.C4)([e.userHasToggled?"user-active":"user-inactive"]),isSymbolActive:e.isSymbolActive,backgroundColor:e.backgroundColor,humanOpinion:e.humanOpinion,onUpdateSymbolState:t=>r.handleSymbolUpdate(e.start,t.newSymbolState,t.userHasToggled),onRemoveBlock:r.onRemoveBlock,onReplaceBlockLabel:r.onReplaceBlockLabel},null,40,["token","class","isSymbolActive","backgroundColor","humanOpinion","onUpdateSymbolState","onRemoveBlock","onReplaceBlockLabel"])))),128))]),(0,s.Lk)("div",gt,[(0,s.bF)(c,{class:"q-mx-sm",color:"primary",outline:"",title:"Undo",onClick:r.undo,label:"Undo"},null,8,["onClick"])]),(0,s.Lk)("div",mt,[(0,s.bF)(c,{color:"red",outline:"",class:"q-mx-sm",title:"Delete all annotations for all sentences/paragraphs",onClick:r.resetBlocks,label:"Reset"},null,8,["onClick"]),(0,s.bF)(c,{class:"q-mx-sm",color:e.$q.dark.isActive?"grey-3":"grey-9",outline:"",title:"Go back one sentence/paragraph",onClick:r.backOneSentence,disabled:0==e.currentIndex,label:"Back"},null,8,["color","onClick","disabled"]),(0,s.bF)(c,{class:"q-mx-sm",color:e.$q.dark.isActive?"grey-3":"grey-9",outline:"",title:"Go forward one sentence/paragraph",onClick:r.skipCurrentSentence,label:"Skip"},null,8,["color","onClick"]),(0,s.bF)(c,{class:"q-mx-sm",color:"green-7",outline:"",title:"Go forward one sentence/paragraph",onClick:r.saveTags,label:"Save"},null,8,["onClick"])])])}var bt={name:"ReviewPage",data:function(){return{tm:new rt([]),currentSentence:{},redone:"",tokenizer:new(ct()),addedTokensStack:[],undoStack:[]}},components:{Token:_e,TokenBlock:Me,ClassesBlock:at},computed:{...(0,L.aH)(["annotations","annotationHistory","classes","currentClass","currentIndex","inputSentences","enableKeyboardShortcuts","annotationPrecision"])},watch:{inputSentences(){this.resetIndex(),this.tokenizeCurrentSentence()},annotations(){this.currentAnnotation!=this.annotations[this.currentIndex]&&this.tokenizeCurrentSentence()},classes(){this.tokenizeCurrentSentence()},annotationPrecision(){this.tokenizeCurrentSentence()}},created(){this.inputSentences.length&&this.tokenizeCurrentSentence(),document.addEventListener("mouseup",this.selectTokens),document.addEventListener("keydown",this.keypress)},beforeUnmount(){document.removeEventListener("mouseup",this.selectTokens),document.removeEventListener("keydown",this.keypress)},methods:{...(0,L.PY)(["nextSentence","previousSentence","resetIndex"]),keypress(e){this.enableKeyboardShortcuts&&(32==e.keyCode?this.saveTags():39==e.keyCode?this.skipCurrentSentence():37==e.keyCode?this.backOneSentence():82!=e.keyCode&&27!=e.keyCode||this.resetBlocks(),e.stopPropagation())},recordAction(e){console.log("Recording action:",e),this.undoStack.push(e),this.undoStack.sort(((e,t)=>t.timestamp-e.timestamp))},handleSymbolUpdate(e,t,n){const o=this.tm.getTokenByStart(e);if(!o)return void console.error("No token found for start:",e);const s=o.isSymbolActive,a=o.userHasToggled;this.tm.updateSymbolState(e,t),o.userHasToggled=n,this.recordAction({type:"symbolUpdate",details:{tokenStart:e,oldSymbolState:s,newSymbolState:t,oldUserHasToggled:a,newUserHasToggled:n,timestamp:Date.now()}}),console.log("Updated symbol state and user toggled status:",e,t,n)},onAddBlock(e,t,n,o,s=!1,a,l="name",r="suggested",i,c=!1,d=0){console.log("Adding block:",e,t,n),this.recordAction({type:"addBlock",details:{start:e,end:t,_class:n,humanOpinion:o,initiallyNLP:s,isLoaded:a,name:l,status:r,annotationHistory:i,userHasToggled:c,isSymbolActive:d,timestamp:Date.now()}}),this.tm.addNewBlock(e,t,n,o,s,a,l,r,i,c,d)},revertAddBlock(e){this.tm.removeBlock(e.start,e.end,e._class)},onRemoveBlock(e){const t=this.tm.getBlockByStart(e);if(!t)return void console.error("Block not found for start:",e);const n={start:t.start,end:t.end,_class:t.label,humanOpinion:t.humanOpinion,initiallyNLP:t.initiallyNLP,isLoaded:t.isLoaded,name:t.name,status:t.status,annotationHistory:t.annotationHistory,userHasToggled:t.userHasToggled,isSymbolActive:t.isSymbolActive};this.recordAction({type:"blockRemove",details:{tokenStart:t.start,blockDetails:n,timestamp:Date.now()}}),console.log("Removing block with details:",n),this.tm.removeBlock(e)},undo(){if(this.undoStack.length>0){const e=this.undoStack.pop();switch(console.log("LAST ACTION BEFORE UNDO ",e),e.type){case"symbolUpdate":this.revertSymbolUpdate(e.details);break;case"blockRemove":this.revertBlockRemove(e.details);break;case"addBlock":this.revertAddBlock(e.details);break;default:console.log("Unhandled action type:",e.type)}}else console.log("Undo Stack is empty")},revertSymbolUpdate(e){this.tm.updateSymbolState(e.tokenStart,e.oldSymbolState);const t=this.tm.getTokenByStart(e.tokenStart);t&&(t.userHasToggled=e.oldUserHasToggled),console.log("Reverted symbol state and user toggled status for token:",e.tokenStart)},revertBlockAdd(e){this.tm.removeBlock(e.tokenStart)},revertBlockRemove(e){if(e&&e.blockDetails){if(console.log("Reverting with class details:",e.blockDetails._class),!e.blockDetails._class)return void console.error("Class details are missing");this.tm.addNewBlock(e.blockDetails.start,e.blockDetails.end,e.blockDetails._class,e.blockDetails.humanOpinion,e.blockDetails.initiallyNLP,e.blockDetails.isLoaded,e.blockDetails.name,e.blockDetails.status,e.blockDetails.annotationHistory,e.blockDetails.userHasToggled,e.blockDetails.isSymbolActive)}else console.error("Missing details for reverting block removal")},applyAnnotationHistory(){const e=this.annotationHistory;e&&e.length>0&&(e.forEach((e=>{const[t,n,o,,s,a,l,r]=e,i="nlp"!==s,c=l,d=this.classes.find((e=>e.name===t)),u=this.determineSymbolState(a);console.log("Added block with symbol ",u),d?this.tm.addNewBlock(n,o,d,i,c,!0,s,a,r,!1,u):console.warn(`Label "${t}" not found in classes.`)})),this.tm.tokens.forEach((t=>{if("token-block"===t.type){const n=e.some((e=>{const[,n,o,,s]=e;return"nlp"===s&&t.start===n&&t.end===o}));t.humanOpinion=!n}})))},determineSymbolState(e){switch(e){case"Accepted":return 1;case"Rejected":return 2;case"Suggested":return 0;default:return 0}},tokenizeCurrentSentence(){let e,t;if(this.currentSentence=this.inputSentences[this.currentIndex],this.currentAnnotation=this.annotations[this.currentIndex],"char"==this.$store.state.annotationPrecision){e=this.currentSentence.text.split(""),t=[];for(let e=0;e<this.currentSentence.text.length;e++)t.push([e,e+1])}else e=this.tokenizer.tokenize(this.currentSentence.text),t=this.tokenizer.span_tokenize(this.currentSentence.text);let n=e.map(((e,n)=>[t[n][0],t[n][1],e]));this.tm=new rt(this.classes),this.tm.setTokensAndAnnotation(n,this.currentAnnotation),this.applyAnnotationHistory()},selectTokens(){let e=document.getSelection();if(e.anchorOffset===e.focusOffset&&e.anchorNode===e.focusNode)return;const t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);let o,s;try{o=parseInt(t.startContainer.parentElement.id.replace("t",""));let e=parseInt(n.endContainer.parentElement.id.replace("t",""));s=e+n.endOffset}catch{return void console.log("selected text were not tokens")}if(!this.classes.length&&e.anchorNode)return alert("There are no Tags available. Kindly add some Tags before tagging."),void e.empty();console.log("adding manual block ",o,s,this.currentClass),this.tm.addNewBlock(o,s,this.currentClass,!0,!1,!1,"name","Suggested",null,!0),this.addedTokensStack.push(o),this.recordAction({type:"addBlock",details:{start:o,end:s,_class:this.currentClass,timestamp:Date.now()}}),e.empty()},onReplaceBlockLabel(e){const t=this.tm.getBlockByStart(e),n=t.start,o=t.end;this.tm.removeBlock(e),void 0!==n&&void 0!==o&&(this.addedTokensStack.push(n),this.tm.addNewBlock(n,o,this.currentClass))},resetBlocks(){this.tm.resetBlocks(),this.addedTokensStack=[]},skipCurrentSentence(){this.nextSentence(),this.tokenizeCurrentSentence()},backOneSentence(){this.previousSentence(),this.tokenizeCurrentSentence()},saveTags(){this.$store.commit("addAnnotation",{text:this.currentSentence.text,entities:this.tm.exportAsAnnotation()}),this.nextSentence(),this.tokenizeCurrentSentence()}}};const yt=(0,D.A)(bt,[["render",kt]]);var ft=yt;H()(bt,"components",{QBtn:Y.A});const vt={class:"px-3"};function At(e,t,n,o,a,l){const r=(0,s.g2)("split-type-selector"),i=(0,s.g2)("annotation-precision-selector"),c=(0,s.g2)("progress-bar"),d=(0,s.g2)("keyboard-shortcuts");return(0,s.uX)(),(0,s.CE)("nav",vt,[(0,s.bF)(r,{class:"mt-4 mb-5"}),(0,s.bF)(i,{class:"mt-4 mb-5"}),(0,s.bF)(c,{class:"mb-5",completed:e.currentIndex,total:e.inputSentences.length},null,8,["completed","total"]),(0,s.bF)(d)])}const St={class:"q-mx-md"},Ct={class:"is-size-6 q-mb-sm"};function wt(e,t,n,o,l,r){const i=(0,s.g2)("q-linear-progress");return(0,s.uX)(),(0,s.CE)("div",St,[(0,s.Lk)("p",Ct,"Tagging Progress ("+(0,a.v_)(n.completed)+"/"+(0,a.v_)(n.total)+")",1),(0,s.bF)(i,{rounded:"",size:"md",color:"primary",value:n.completed/n.total},null,8,["value"])])}var xt={name:"ProgressBar",props:{completed:{type:Number,required:!0,default:0},total:{type:Number,required:!0}},computed:{completedPercent(){return parseInt(this.completed/this.total*100)}}},Lt=n(705);const Ft=(0,D.A)(xt,[["render",wt]]);var Tt=Ft;H()(xt,"components",{QLinearProgress:Lt.A});const qt={class:"q-pa-md"},Et={key:0,class:"q-px-md"};function Bt(e,t,n,o,a,l){const r=(0,s.g2)("q-select"),i=(0,s.g2)("q-input");return(0,s.uX)(),(0,s.CE)("section",null,[(0,s.Lk)("div",qt,[(0,s.bF)(r,{outlined:"","bg-color":e.$q.dark.isActive?"dark":"white",modelValue:l.splitType,"onUpdate:modelValue":t[0]||(t[0]=e=>l.splitType=e),options:a.splitOptions,"map-options":!0,label:"Text Seperator"},null,8,["bg-color","modelValue","options"])]),"custom"===l.splitType?((0,s.uX)(),(0,s.CE)("div",Et,[(0,s.bF)(i,{label:"Separator","bg-color":"white",outlined:"",modelValue:a.customSeparator,"onUpdate:modelValue":t[1]||(t[1]=e=>a.customSeparator=e),onChange:l.separatorChanged,disabled:e.annotations.length},null,8,["modelValue","onChange","disabled"])])):(0,s.Q3)("",!0)])}var Dt={name:"SpitTypeSelector",data(){return{customSeparator:"---",splitOptions:[{label:"New Line",value:"newline"},{label:"An Empty Line",value:"emptyline"},{label:"Custom String",value:"custom"}]}},computed:{...(0,L.aH)(["annotations"]),splitType:{get(){switch(this.$store.state.separator){case"\n":return"newline";case"\n\n":return"emptyline";default:return"custom"}},set(e){switch(e.value){case"newline":this.$store.commit("setSeparator","\n");break;case"emptyline":this.$store.commit("setSeparator","\n\n");break;default:this.$store.commit("setSeparator","---");break}}}},methods:{separatorChanged(){this.$store.commit("setSeparator",this.customSeparator)}}},Pt=n(7695);const Nt=(0,D.A)(Dt,[["render",Bt]]);var It=Nt;H()(Dt,"components",{QSelect:Pt.A,QInput:ge.A});const Rt={class:"q-px-md q-pb-md"};function Ht(e,t,n,o,a,l){const r=(0,s.g2)("q-select");return(0,s.uX)(),(0,s.CE)("section",null,[(0,s.Lk)("div",Rt,[(0,s.bF)(r,{outlined:"","bg-color":e.$q.dark.isActive?"dark":"white",modelValue:l.precisionType,"onUpdate:modelValue":t[0]||(t[0]=e=>l.precisionType=e),options:a.precisionOptions,"map-options":!0,label:"Annotation Precision"},null,8,["bg-color","modelValue","options"])])])}var Ot={name:"AnnotationPrecisionSelector",data(){return{precisionOptions:[{label:"Word Level",value:"word"},{label:"Character Level",value:"char"}]}},computed:{precisionType:{get(){switch(this.$store.state.annotationPrecision){case"word":return"word";case"char":return"char";default:return"word"}},set(e){switch(e.value){case"word":this.$store.commit("setAnnotationPrecision","word");break;case"char":this.$store.commit("setAnnotationPrecision","char");break;default:this.$store.commit("setAnnotationPrecision","word");break}}}}};const Ut=(0,D.A)(Ot,[["render",Ht]]);var Wt=Ut;H()(Ot,"components",{QSelect:Pt.A});const Qt=(0,s.Lk)("br",null,null,-1),jt=(0,s.Lk)("div",{class:"column"},[(0,s.Lk)("div",{class:"row",style:{height:"40px"}},[(0,s.Lk)("div",{class:"col-4"},"Num Keys:"),(0,s.Lk)("div",{class:"col"},"Change classes")]),(0,s.Lk)("div",{class:"row",style:{height:"60px"}},[(0,s.Lk)("div",{class:"col-4"},"Space Bar:"),(0,s.Lk)("div",{class:"col"},"Save and move to the next sentence")]),(0,s.Lk)("div",{class:"row",style:{height:"60px"}},[(0,s.Lk)("div",{class:"col-4"},"Right Arrow:"),(0,s.Lk)("div",{class:"col"},"Skip and move to the next sentence")]),(0,s.Lk)("div",{class:"row",style:{height:"60px"}},[(0,s.Lk)("div",{class:"col-4"},"Left Arrow:"),(0,s.Lk)("div",{class:"col"},"Go back to the previous sentence")]),(0,s.Lk)("div",{class:"row",style:{height:"60px"}},[(0,s.Lk)("div",{class:"col-4"},"Escape:"),(0,s.Lk)("div",{class:"col"},"Discard changes to the current sentence")])],-1);function Xt(e,t,n,o,a,l){const r=(0,s.g2)("q-toggle"),i=(0,s.g2)("q-icon"),c=(0,s.g2)("q-card-section"),d=(0,s.g2)("q-card"),u=(0,s.g2)("q-dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("section",null,[Qt,(0,s.bF)(r,{modelValue:e.enableKeyboardShortcuts,"onUpdate:modelValue":t[0]||(t[0]=t=>e.enableKeyboardShortcuts=t),label:"Keyboard Shortcuts",onClick:l.enableKeyboardShortcutsChanged},null,8,["modelValue","onClick"]),(0,s.bF)(i,{style:{"margin-left":"5px","margin-top":"3px"},color:e.$q.dark.isActive?"grey-4":"grey-10",name:"far fa-question-circle",onClick:t[1]||(t[1]=t=>e.showShortcutHelp=!0)},null,8,["color"])]),(0,s.bF)(u,{"model-value":e.showShortcutHelp,onHide:t[2]||(t[2]=t=>e.showShortcutHelp=!1)},{default:(0,s.k6)((()=>[(0,s.bF)(d,{style:{"min-width":"100px",padding:"10px","border-radius":"10px"}},{default:(0,s.k6)((()=>[(0,s.bF)(c,{class:"text-body1"},{default:(0,s.k6)((()=>[jt])),_:1})])),_:1})])),_:1},8,["model-value"])],64)}var _t={name:"KeyboardShortcuts",data:function(){return{enableKeyboardShortcuts:!1,showShortcutHelp:!1}},methods:{enableKeyboardShortcutsChanged(){this.$store.commit("setKeyboardShortcuts",this.enableKeyboardShortcuts)}}},$t=n(6269);const zt=(0,D.A)(_t,[["render",Xt]]);var Kt=zt;H()(_t,"components",{QToggle:$t.A,QIcon:pe.A,QDialog:K.A,QCard:G.A,QCardSection:M.A});var Gt={name:"AnnotationSidebar",components:{ProgressBar:Tt,SplitTypeSelector:It,AnnotationPrecisionSelector:Wt,KeyboardShortcuts:Kt},computed:{...(0,L.aH)(["currentIndex","inputSentences"])}};const Mt=(0,D.A)(Gt,[["render",At]]);var Vt=Mt;const Yt={class:"column items-center"},Jt={class:"text-h2 text-white"},Zt=(0,s.Lk)("p",{class:"text-h3 text-white"}," Drop file to upload. ",-1);function en(e,t){const n=(0,s.g2)("q-icon");return(0,s.uX)(),(0,s.CE)("div",{class:"fullscreen column justify-center bg-black",style:(0,a.Tr)({opacity:"0.85"})},[(0,s.Lk)("div",Yt,[(0,s.Lk)("p",Jt,[(0,s.bF)(n,{name:"fas fa-upload"})]),Zt])],4)}const tn={},nn=(0,D.A)(tn,[["render",en]]);var on=nn;H()(tn,"components",{QIcon:pe.A});var sn={name:"LayoutDefault",setup(){const e=(0,W.A)();return{notify(t,n,o){e.notify({icon:t,message:n,color:o,position:"top",timeout:2e3,actions:[{label:"Dismiss",color:"white"}]})}}},data(){return{overlayActive:!1,pendingFileDrop:null}},components:{MenuBar:ke,StartPage:Ie,AnnotationPage:pt,ReviewPage:ft,AnnotationSidebar:Vt,DragNDropOverlay:on,ExitDialog:ae},computed:{...(0,L.aH)(["annotations","classes","currentPage"])},methods:{...(0,L.PY)(["loadClasses","loadAnnotations","setInputSentences","clearAllAnnotations","resetIndex","setCurrentPage"]),switchToPage(e){console.log("Changing current page to",e),this.setCurrentPage(e),console.log("Current page is now",this.currentPage)},onDragEnter(){console.log("Here"),this.overlayActive=!0},onDragLeave(){this.overlayActive=!1},onDrop(e){console.log(e),this.overlayActive=!1,this.pendingFileDrop=e.dataTransfer.files[0],"start"==this.currentPage&&this.processFileDrop()},processFileDrop(){let e=this.pendingFileDrop.name.split(".").pop(),t=new FileReader;t.onload=t=>{let n=t.target.result;this.setInputSentences(n),this.clearAllAnnotations(),this.resetIndex(),"txt"===e?this.switchToPage("annotate"):"json"===e?this.switchToPage("review"):alert("Please upload either a .txt or a .json file.")},t.readAsText(this.pendingFileDrop),this.pendingFileDrop=null}}},an=n(4421),ln=n(8811),rn=n(6671);const cn=(0,D.A)(sn,[["render",l]]);var dn=cn;H()(sn,"components",{QLayout:an.A,QDrawer:ln.A,QPageContainer:rn.A});n(8753);var un=n(3652);const pn=["red-11","blue-11","light-green-11","deep-orange-11","pink-11","light-blue-11","lime-11","brown-11","purple-11","cyan-11","yellow-11","grey-11","deep-purple-11","teal-11","amber-11","blue-grey-11","indigo-11","green-11","orange-11"],hn={setCurrentPage(e,t){e.currentPage=t},addToUndoStack(e,{undoAction:t,actionDescription:n}){e.undoStack.push({undoAction:t,actionDescription:n})},undoAction(e,t){t&&"string"===typeof t.type&&"function"===typeof this._mutations[t.type]&&this._mutations[t.type][0](e,t.payload)},undoLastAction(e){if(e.undoStack.length>0){const t=e.undoStack.pop();t.undoAction(),console.log(`Undid action: ${t.actionDescription}`)}else console.warn("Undo stack is empty.")},clearUndoStack(e){e.undoStack=[]},loadClasses(e,t){if(!Array.isArray(t))throw new Error("loadClasses: payload must be an array");let n=t.reduce(((e,t)=>e&&"object"===typeof t&&"id"in t&&"name"in t&&"color"in t),!0);if(!n)throw new Error("loadClasses: payload has invalid schema");e.classes=t,e.currentClass=e.classes[0],un.A.set("tags",e.classes)},setInputSentences(e,t){try{let e;if("string"!==typeof t){if(t instanceof File){const o=new FileReader;return o.onload=function(t){try{const o=t.target.result;e={annotations:[[o,{entities:[]}]],classes:[]},n(e)}catch(o){console.error(`Error processing text file: ${o.message}`)}},void o.readAsText(t)}throw new Error("Invalid payload type")}try{e=JSON.parse(t)}catch(o){e={annotations:[[t,{entities:[]}]],classes:[]}}n(e)}catch(s){console.error(`Error processing payload: ${s.message}`)}function n(t){const n=t.annotations.map((([t,n],o)=>{let s=[];return console.log("help"),n.entities.forEach((e=>{if(e.length>=3){console.log("help");const n=e[0],o=e[1],a=e[2],l=a[a.length-1],r=a[0],i=l[3],c=l[2],d=l[0];var t=!1;"nlp"===r[2]&&(t=!0),console.log("label: ",i,"start: ",n,"end: ",o,"type: ",l,"name: ",c,"status: ",d),s.push([i,n,o,l,c,d,t,a]),console.log("Loaded annotation history:",a)}})),e.annotationHistory=s,console.log("Updated state.annotationHistory:",e.annotationHistory),{id:o,text:t}}));e.inputSentences=n,e.originalText=n.map((e=>e.text)).join(e.separator),t.classes&&Array.isArray(t.classes)&&hn.loadClasses(e,t.classes)}},addClass(e,t){const n=e.classes.find((e=>e.name===t));if(n)return void console.log("Class already exists, returning.");const o=e.classes.reduce(((e,t)=>t.id>e?t.id:e),0),s={id:o+1,name:t,color:pn[o%pn.length]};e.classes.some((e=>e.name===s.name))||(e.classes=[...e.classes,s],1===e.classes.length&&(e.currentClass=e.classes[0],console.log("Updated currentClass:",e.currentClass)))},removeClass(e,t){e.classes=e.classes.filter((e=>e.id!=t)),e.currentClass.id===t&&(e.currentClass=e.classes[0])},setCurrentClass(e,t){e.currentClass=e.classes[t]},addAnnotation(e,t){e.annotations[e.currentIndex]=t,e.currentAnnotation=t},clearAllAnnotations(e){e.annotations=[],e.currentAnnotation={}},setSeparator(e,t){e.separator=t;const n=e.originalText.split(e.separator);e.inputSentences=n.map(((e,t)=>({id:t,text:e})))},setAnnotationPrecision(e,t){e.annotationPrecision=t},setKeyboardShortcuts(e,t){e.enableKeyboardShortcuts=t},nextSentence(e){e.currentIndex<e.inputSentences.length-1?(e.currentIndex+=1,e.currentAnnotation=e.annotations[e.currentIndex]||{}):alert("You have completed all the sentences")},previousSentence(e){e.currentIndex>0?(e.currentIndex-=1,e.currentAnnotation=e.annotations[e.currentIndex]):alert("You are at the beginning of all sentences")},resetIndex(e){e.currentIndex=0},loadAnnotations(e,t){let n="object"===typeof t&&"annotations"in t&&"classes"in t;if(!n)throw new Error("loadAnnotations: payload has invalid schema");let o=t.annotations;if(!Array.isArray(o))throw new Error("loadAnnotations: payload must be an array");let s=[];for(var a=0;a<o.length;a++){if(null==o[a])continue;let e={text:o[a][0],entities:o[a][1].entities};s[a]=e}e.annotations=s,e.currentAnnotation=e.annotations[e.currentIndex]}},gn={},mn={createNewClass({commit:e,state:t},n){return new Promise(((o,s)=>{e("addClass",n);try{un.A.set("tags",t.classes)}catch(a){s(a)}o()}))},deleteClass({commit:e,state:t},n){e("removeClass",n),un.A.set("tags",t.classes)}};window.addEventListener("beforeunload",(async e=>{e.returnValue="Please make sure you export annotations before closing the file."}));var kn={state(){let e=un.A.getItem("tags");return{annotations:[],annotationHistory:[],undoStack:[],classes:e||[],inputSentences:[],originalText:"",separator:"\n",enableKeyboardShortcuts:!1,annotationPrecision:"word",currentAnnotation:{},currentClass:e&&e[0]||{},currentIndex:0,currentSentence:"",currentPage:"start"}},getters:gn,mutations:hn,actions:mn},bn=n(1519),yn=n(2689),fn=n.n(yn),vn=n(135),An={config:{},plugins:{Notify:vn.A},iconSet:fn()};const Sn=(0,o.Ef)(dn).use(bn.A,An).use((0,L.y$)(kn));Sn.mount("#app")}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,s,a){if(!o){var l=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],a=e[d][2];for(var r=!0,i=0;i<o.length;i++)(!1&a||l>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(r=!1,a<l&&(l=a));if(r){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,s,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/TeAM-NER/"}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,a,l=o[0],r=o[1],i=o[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(i)var d=i(n)}for(t&&t(o);c<l.length;c++)a=l[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},o=self["webpackChunkner_annotator"]=self["webpackChunkner_annotator"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(4631)}));o=n.O(o)})();
//# sourceMappingURL=app.7c1588fe.js.map